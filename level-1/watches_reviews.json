{
  "paragraphs": [
    {
      "title": "",
      "text": "%pyspark\nfrom pyspark import SparkFiles\n# Load in watches.csv from S3 into a DataFrame\nurl \u003d \"https://s3.amazonaws.com/amazon-reviews-pds/tsv/amazon_reviews_us_Watches_v1_00.tsv.gz\"\nspark.sparkContext.addFile(url)\n\nwatches_df \u003d spark.read.option(\"header\", \"true\").csv(\"s3a://amazon-reviews-pds/tsv/amazon_reviews_us_Watches_v1_00.tsv.gz\", inferSchema\u003dTrue, sep\u003d\"\\t\")\nwatches_df.show(10)\nwatches_df.count()",
      "user": "",
      "dateUpdated": "Dec 16, 2019 12:09:47 AM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+-----------+-----------+--------------+----------+--------------+--------------------+----------------+-----------+-------------+-----------+----+-----------------+--------------------+--------------------+-------------------+\n|marketplace|customer_id|     review_id|product_id|product_parent|       product_title|product_category|star_rating|helpful_votes|total_votes|vine|verified_purchase|     review_headline|         review_body|        review_date|\n+-----------+-----------+--------------+----------+--------------+--------------------+----------------+-----------+-------------+-----------+----+-----------------+--------------------+--------------------+-------------------+\n|         US|    3653882|R3O9SGZBVQBV76|B00FALQ1ZC|     937001370|Invicta Women\u0027s 1...|         Watches|          5|            0|          0|   N|                Y|          Five Stars|Absolutely love t...|2015-08-31 00:00:00|\n|         US|   14661224| RKH8BNC3L5DLF|B00D3RGO20|     484010722|Kenneth Cole New ...|         Watches|          5|            0|          0|   N|                Y|I love thiswatch ...|I love this watch...|2015-08-31 00:00:00|\n|         US|   27324930|R2HLE8WKZSU3NL|B00DKYC7TK|     361166390|Ritche 22mm Black...|         Watches|          2|            1|          1|   N|                Y|           Two Stars|           Scratches|2015-08-31 00:00:00|\n|         US|    7211452|R31U3UH5AZ42LL|B000EQS1JW|     958035625|Citizen Men\u0027s BM8...|         Watches|          5|            0|          0|   N|                Y|          Five Stars|It works well on ...|2015-08-31 00:00:00|\n|         US|   12733322|R2SV659OUJ945Y|B00A6GFD7S|     765328221|Orient ER27009B M...|         Watches|          4|            0|          0|   N|                Y|Beautiful face, b...|Beautiful watch f...|2015-08-31 00:00:00|\n|         US|    6576411| RA51CP8TR5A2L|B00EYSOSE8|     230493695|Casio Men\u0027s GW-94...|         Watches|          5|            0|          0|   N|                Y|       No complaints|i love this watch...|2015-08-31 00:00:00|\n|         US|   11811565| RB2Q7DLDN6TH6|B00WM0QA3M|     549298279|Fossil Women\u0027s ES...|         Watches|          5|            1|          1|   N|                Y|          Five Stars|for my wife and s...|2015-08-31 00:00:00|\n|         US|   49401598|R2RHFJV0UYBK3Y|B00A4EYBR0|     844009113|INFANTRY Mens Nig...|         Watches|          1|            1|          5|   N|                N|I was about to bu...|I was about to bu...|2015-08-31 00:00:00|\n|         US|   45925069|R2Z6JOQ94LFHEP|B00MAMPGGE|     263720892|G-Shock Men\u0027s Gre...|         Watches|          5|            1|          2|   N|                Y|      Perfect watch!|Watch is perfect....|2015-08-31 00:00:00|\n|         US|   44751341| RX27XIIWY5JPB|B004LBPB7Q|     124278407|Heiden Quad Watch...|         Watches|          4|            0|          0|   N|                Y|Great quality and...|Great quality and...|2015-08-31 00:00:00|\n+-----------+-----------+--------------+----------+--------------+--------------------+----------------+-----------+-------------+-----------+----+-----------------+--------------------+--------------------+-------------------+\nonly showing top 10 rows\n\n960872",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20191215-144720_386998642",
      "dateCreated": "Dec 15, 2019 2:47:20 PM",
      "dateStarted": "Dec 16, 2019 12:08:43 AM",
      "dateFinished": "Dec 16, 2019 12:09:47 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nwatches_df \u003d watches_df.dropDuplicates()\nwatches_df.count()",
      "user": "",
      "dateUpdated": "Dec 16, 2019 12:10:09 AM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "960872",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20191215-170655_1207523701",
      "dateCreated": "Dec 15, 2019 5:06:55 PM",
      "dateStarted": "Dec 16, 2019 12:09:47 AM",
      "dateFinished": "Dec 16, 2019 12:10:09 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nwatches_df.printSchema() ",
      "user": "",
      "dateUpdated": "Dec 16, 2019 12:10:09 AM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "root\n |-- marketplace: string (nullable \u003d true)\n |-- customer_id: integer (nullable \u003d true)\n |-- review_id: string (nullable \u003d true)\n |-- product_id: string (nullable \u003d true)\n |-- product_parent: integer (nullable \u003d true)\n |-- product_title: string (nullable \u003d true)\n |-- product_category: string (nullable \u003d true)\n |-- star_rating: integer (nullable \u003d true)\n |-- helpful_votes: integer (nullable \u003d true)\n |-- total_votes: integer (nullable \u003d true)\n |-- vine: string (nullable \u003d true)\n |-- verified_purchase: string (nullable \u003d true)\n |-- review_headline: string (nullable \u003d true)\n |-- review_body: string (nullable \u003d true)\n |-- review_date: timestamp (nullable \u003d true)\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20191215-145058_1670960149",
      "dateCreated": "Dec 15, 2019 2:50:58 PM",
      "dateStarted": "Dec 16, 2019 12:10:09 AM",
      "dateFinished": "Dec 16, 2019 12:10:09 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nreview_id_df \u003d watches_df.select(\"review_id\", \"customer_id\", \"product_id\", \"product_parent\", \"review_date\")\nreview_id_df.show()",
      "user": "",
      "dateUpdated": "Dec 16, 2019 12:10:30 AM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+--------------+-----------+----------+--------------+-------------------+\n|     review_id|customer_id|product_id|product_parent|        review_date|\n+--------------+-----------+----------+--------------+-------------------+\n|R1012EIMH2B928|   23713519|B000GB1R96|     474494795|2015-01-23 00:00:00|\n|R10374ESWDS6U7|    6297923|B00BD94CGU|     802883428|2013-10-14 00:00:00|\n|R10464NBFUUZKK|   10517811|B00RL4W416|     882378227|2015-06-16 00:00:00|\n|R104ZHZNLUG56V|   36027555|B00KNNXP5Q|      69676058|2014-08-12 00:00:00|\n|R1050KH5I6Q82F|    8096533|B00BK2D7QQ|     299965414|2015-08-27 00:00:00|\n|R105OGH5R1MYFY|   27069825|B000OR66D4|     411782531|2008-07-06 00:00:00|\n|R106BAPRPNZNC9|   17003344|B0037KLB3A|     409688729|2012-07-07 00:00:00|\n|R106CG9LOK6LS0|   18126586|B005XUHR4E|     544964514|2014-04-11 00:00:00|\n|R107DR8924IDG6|   34598399|B004BYJXRC|     301129086|2013-08-24 00:00:00|\n|R10A96C5D8M9FT|   16048697|B009N8XSJU|     859280564|2015-01-04 00:00:00|\n|R10CGDSH66MZIM|   10507609|B002CVUO9W|     981414909|2013-03-04 00:00:00|\n|R10DI7DFILVNYD|   46382357|B007SUZGUO|     649291489|2013-11-20 00:00:00|\n| R10EBMRNTEAFU|   30187835|B00C5JHYAI|     467887721|2014-01-06 00:00:00|\n|R10ENSAS9RV07M|    2374610|B000820YD8|     459971973|2015-06-25 00:00:00|\n|R10GWK6OU8Y3AR|   10424800|B004D35W8A|     623433431|2014-07-20 00:00:00|\n|R10H0QF8UMCTBS|   48042734|B00DBUVM1W|     289856998|2014-08-20 00:00:00|\n|R10IFUPOW8IM1L|   14286242|B00843L4OG|     350331890|2015-07-22 00:00:00|\n|R10JERMDEMTH4B|   19773818|B006IUCZ4U|     526681294|2013-06-07 00:00:00|\n|R10JEZ85VG2VAA|   37699554|B00186YU38|     102067990|2011-03-12 00:00:00|\n|R10K5SUFDBF0F4|   10011930|B00EZJ8IAG|     704330647|2015-06-20 00:00:00|\n+--------------+-----------+----------+--------------+-------------------+\nonly showing top 20 rows\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20191215-152100_928396475",
      "dateCreated": "Dec 15, 2019 3:21:00 PM",
      "dateStarted": "Dec 16, 2019 12:10:09 AM",
      "dateFinished": "Dec 16, 2019 12:10:30 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nimport pandas as pd\npandas_df_review_id \u003d review_id_df.toPandas() \npandas_df_review_id.head()",
      "user": "",
      "dateUpdated": "Dec 16, 2019 12:11:04 AM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "        review_id  customer_id  product_id  product_parent review_date\n0  R1012EIMH2B928     23713519  B000GB1R96       474494795  2015-01-23\n1  R10374ESWDS6U7      6297923  B00BD94CGU       802883428  2013-10-14\n2  R10464NBFUUZKK     10517811  B00RL4W416       882378227  2015-06-16\n3  R104ZHZNLUG56V     36027555  B00KNNXP5Q        69676058  2014-08-12\n4  R1050KH5I6Q82F      8096533  B00BK2D7QQ       299965414  2015-08-27",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20191215-181123_1106006391",
      "dateCreated": "Dec 15, 2019 6:11:23 PM",
      "dateStarted": "Dec 16, 2019 12:10:30 AM",
      "dateFinished": "Dec 16, 2019 12:11:04 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\npandas_df_review_id[\u0027review_date\u0027] \u003d pandas_df_review_id[\u0027review_date\u0027].astype(str)\npandas_df_review_id[\u0027review_date\u0027] \u003d pandas_df_review_id[\u0027review_date\u0027].str.split(\" \", n \u003d 1, expand \u003d True)\npandas_df_review_id.head()",
      "user": "",
      "dateUpdated": "Dec 16, 2019 12:11:10 AM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "        review_id  customer_id  product_id  product_parent review_date\n0  R1012EIMH2B928     23713519  B000GB1R96       474494795  2015-01-23\n1  R10374ESWDS6U7      6297923  B00BD94CGU       802883428  2013-10-14\n2  R10464NBFUUZKK     10517811  B00RL4W416       882378227  2015-06-16\n3  R104ZHZNLUG56V     36027555  B00KNNXP5Q        69676058  2014-08-12\n4  R1050KH5I6Q82F      8096533  B00BK2D7QQ       299965414  2015-08-27",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20191215-213133_1621715486",
      "dateCreated": "Dec 15, 2019 9:31:33 PM",
      "dateStarted": "Dec 16, 2019 12:11:04 AM",
      "dateFinished": "Dec 16, 2019 12:11:10 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nspark_df_review_id \u003d spark.createDataFrame(pandas_df_review_id)\nspark_df_review_id.show()",
      "user": "",
      "dateUpdated": "Dec 16, 2019 12:11:52 AM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+--------------+-----------+----------+--------------+-----------+\n|     review_id|customer_id|product_id|product_parent|review_date|\n+--------------+-----------+----------+--------------+-----------+\n|R1012EIMH2B928|   23713519|B000GB1R96|     474494795| 2015-01-23|\n|R10374ESWDS6U7|    6297923|B00BD94CGU|     802883428| 2013-10-14|\n|R10464NBFUUZKK|   10517811|B00RL4W416|     882378227| 2015-06-16|\n|R104ZHZNLUG56V|   36027555|B00KNNXP5Q|      69676058| 2014-08-12|\n|R1050KH5I6Q82F|    8096533|B00BK2D7QQ|     299965414| 2015-08-27|\n|R105OGH5R1MYFY|   27069825|B000OR66D4|     411782531| 2008-07-06|\n|R106BAPRPNZNC9|   17003344|B0037KLB3A|     409688729| 2012-07-07|\n|R106CG9LOK6LS0|   18126586|B005XUHR4E|     544964514| 2014-04-11|\n|R107DR8924IDG6|   34598399|B004BYJXRC|     301129086| 2013-08-24|\n|R10A96C5D8M9FT|   16048697|B009N8XSJU|     859280564| 2015-01-04|\n|R10CGDSH66MZIM|   10507609|B002CVUO9W|     981414909| 2013-03-04|\n|R10DI7DFILVNYD|   46382357|B007SUZGUO|     649291489| 2013-11-20|\n| R10EBMRNTEAFU|   30187835|B00C5JHYAI|     467887721| 2014-01-06|\n|R10ENSAS9RV07M|    2374610|B000820YD8|     459971973| 2015-06-25|\n|R10GWK6OU8Y3AR|   10424800|B004D35W8A|     623433431| 2014-07-20|\n|R10H0QF8UMCTBS|   48042734|B00DBUVM1W|     289856998| 2014-08-20|\n|R10IFUPOW8IM1L|   14286242|B00843L4OG|     350331890| 2015-07-22|\n|R10JERMDEMTH4B|   19773818|B006IUCZ4U|     526681294| 2013-06-07|\n|R10JEZ85VG2VAA|   37699554|B00186YU38|     102067990| 2011-03-12|\n|R10K5SUFDBF0F4|   10011930|B00EZJ8IAG|     704330647| 2015-06-20|\n+--------------+-----------+----------+--------------+-----------+\nonly showing top 20 rows\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20191215-212854_2130712950",
      "dateCreated": "Dec 15, 2019 9:28:54 PM",
      "dateStarted": "Dec 16, 2019 12:11:10 AM",
      "dateFinished": "Dec 16, 2019 12:11:52 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nspark_df_review_id \u003d spark_df_review_id.withColumn(\"review_date\", spark_df_review_id[\"review_date\"].cast(\"date\"))\nspark_df_review_id.show()",
      "user": "",
      "dateUpdated": "Dec 16, 2019 12:11:53 AM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+--------------+-----------+----------+--------------+-----------+\n|     review_id|customer_id|product_id|product_parent|review_date|\n+--------------+-----------+----------+--------------+-----------+\n|R1012EIMH2B928|   23713519|B000GB1R96|     474494795| 2015-01-23|\n|R10374ESWDS6U7|    6297923|B00BD94CGU|     802883428| 2013-10-14|\n|R10464NBFUUZKK|   10517811|B00RL4W416|     882378227| 2015-06-16|\n|R104ZHZNLUG56V|   36027555|B00KNNXP5Q|      69676058| 2014-08-12|\n|R1050KH5I6Q82F|    8096533|B00BK2D7QQ|     299965414| 2015-08-27|\n|R105OGH5R1MYFY|   27069825|B000OR66D4|     411782531| 2008-07-06|\n|R106BAPRPNZNC9|   17003344|B0037KLB3A|     409688729| 2012-07-07|\n|R106CG9LOK6LS0|   18126586|B005XUHR4E|     544964514| 2014-04-11|\n|R107DR8924IDG6|   34598399|B004BYJXRC|     301129086| 2013-08-24|\n|R10A96C5D8M9FT|   16048697|B009N8XSJU|     859280564| 2015-01-04|\n|R10CGDSH66MZIM|   10507609|B002CVUO9W|     981414909| 2013-03-04|\n|R10DI7DFILVNYD|   46382357|B007SUZGUO|     649291489| 2013-11-20|\n| R10EBMRNTEAFU|   30187835|B00C5JHYAI|     467887721| 2014-01-06|\n|R10ENSAS9RV07M|    2374610|B000820YD8|     459971973| 2015-06-25|\n|R10GWK6OU8Y3AR|   10424800|B004D35W8A|     623433431| 2014-07-20|\n|R10H0QF8UMCTBS|   48042734|B00DBUVM1W|     289856998| 2014-08-20|\n|R10IFUPOW8IM1L|   14286242|B00843L4OG|     350331890| 2015-07-22|\n|R10JERMDEMTH4B|   19773818|B006IUCZ4U|     526681294| 2013-06-07|\n|R10JEZ85VG2VAA|   37699554|B00186YU38|     102067990| 2011-03-12|\n|R10K5SUFDBF0F4|   10011930|B00EZJ8IAG|     704330647| 2015-06-20|\n+--------------+-----------+----------+--------------+-----------+\nonly showing top 20 rows\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20191215-214824_690804602",
      "dateCreated": "Dec 15, 2019 9:48:24 PM",
      "dateStarted": "Dec 16, 2019 12:11:52 AM",
      "dateFinished": "Dec 16, 2019 12:11:53 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nproducts_df \u003d watches_df.select(\"product_id\", \"product_title\")\nproducts_df.show()",
      "user": "",
      "dateUpdated": "Dec 16, 2019 12:12:14 AM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+----------+--------------------+\n|product_id|       product_title|\n+----------+--------------------+\n|B000GB1R96|Casio EF106D-2AV ...|\n|B00BD94CGU|Swiss Legend Men\u0027...|\n|B00RL4W416|Akribos XXIV Men\u0027...|\n|B00KNNXP5Q|Hydia Watches Got...|\n|B00BK2D7QQ|Stuhrling Origina...|\n|B000OR66D4|Casio G-Shock Mudman|\n|B0037KLB3A|Steiner Women\u0027s S...|\n|B005XUHR4E|Juicy Couture Wom...|\n|B004BYJXRC|Frenzy Kids\u0027 FR30...|\n|B009N8XSJU|MeilyÂ® Silicone R...|\n|B002CVUO9W|Diplomat Double M...|\n|B007SUZGUO|XOXO Women\u0027s XO54...|\n|B00C5JHYAI|G-Shock: Nigel Sy...|\n|B000820YD8|Invicta Men\u0027s 007...|\n|B004D35W8A|CASIO Men\u0027s MW600...|\n|B00DBUVM1W|Citizen JY8034-58...|\n|B00843L4OG|Citizen Men\u0027s AO9...|\n|B006IUCZ4U|Marc by Marc Jaco...|\n|B00186YU38|Casio Men\u0027s WV200...|\n|B00EZJ8IAG|SWISS REIMAGINED ...|\n+----------+--------------------+\nonly showing top 20 rows\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20191215-152613_682348920",
      "dateCreated": "Dec 15, 2019 3:26:13 PM",
      "dateStarted": "Dec 16, 2019 12:11:53 AM",
      "dateFinished": "Dec 16, 2019 12:12:14 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nproducts_df.count()",
      "user": "",
      "dateUpdated": "Dec 16, 2019 12:15:12 AM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "960872",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20191216-001331_904764343",
      "dateCreated": "Dec 16, 2019 12:13:31 AM",
      "dateStarted": "Dec 16, 2019 12:14:50 AM",
      "dateFinished": "Dec 16, 2019 12:15:12 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nproducts_df \u003d products_df.dropDuplicates()",
      "user": "",
      "dateUpdated": "Dec 16, 2019 12:15:12 AM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "",
      "id": "20191216-001333_2009533717",
      "dateCreated": "Dec 16, 2019 12:13:33 AM",
      "dateStarted": "Dec 16, 2019 12:15:12 AM",
      "dateFinished": "Dec 16, 2019 12:15:12 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nproducts_df.count()",
      "user": "",
      "dateUpdated": "Dec 16, 2019 12:15:37 AM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "149705",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20191216-001417_1465846556",
      "dateCreated": "Dec 16, 2019 12:14:17 AM",
      "dateStarted": "Dec 16, 2019 12:15:12 AM",
      "dateFinished": "Dec 16, 2019 12:15:37 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nimport pandas as pd\ndf_customers \u003d watches_df.select(\"customer_id\")\npandas_df_customer \u003d df_customers.toPandas() \npandas_df_customer.head()",
      "user": "",
      "dateUpdated": "Dec 16, 2019 12:16:34 AM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "   customer_id\n0     23713519\n1      6297923\n2     10517811\n3     36027555\n4      8096533",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20191215-172148_1914469131",
      "dateCreated": "Dec 15, 2019 5:21:48 PM",
      "dateStarted": "Dec 16, 2019 12:16:07 AM",
      "dateFinished": "Dec 16, 2019 12:16:34 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nvalue_counts \u003d pandas_df_customer.customer_id.value_counts()",
      "user": "",
      "dateUpdated": "Dec 16, 2019 12:16:34 AM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "",
      "id": "20191215-172552_364847528",
      "dateCreated": "Dec 15, 2019 5:25:52 PM",
      "dateStarted": "Dec 16, 2019 12:16:34 AM",
      "dateFinished": "Dec 16, 2019 12:16:34 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\npd_customer_df \u003d pd.DataFrame(value_counts)\npd_customer_df.head()",
      "user": "",
      "dateUpdated": "Dec 16, 2019 12:16:34 AM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "          customer_id\n42418272          407\n40765068          127\n19619134          121\n52460875          111\n5072809           106",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20191215-172912_4570666",
      "dateCreated": "Dec 15, 2019 5:29:12 PM",
      "dateStarted": "Dec 16, 2019 12:16:34 AM",
      "dateFinished": "Dec 16, 2019 12:16:34 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\npd_customer_df \u003d pd_customer_df.reset_index()\npd_customer_df.columns \u003d [\u0027customer_id\u0027, \u0027customer_count\u0027]",
      "user": "",
      "dateUpdated": "Dec 16, 2019 12:16:34 AM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "",
      "id": "20191215-173023_62887366",
      "dateCreated": "Dec 15, 2019 5:30:23 PM",
      "dateStarted": "Dec 16, 2019 12:16:34 AM",
      "dateFinished": "Dec 16, 2019 12:16:34 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nvine_df \u003d watches_df.select(\"review_id\", \"star_rating\", \"helpful_votes\", \"total_votes\", \"vine\")\nvine_df.show()",
      "user": "",
      "dateUpdated": "Dec 16, 2019 12:16:57 AM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+--------------+-----------+-------------+-----------+----+\n|     review_id|star_rating|helpful_votes|total_votes|vine|\n+--------------+-----------+-------------+-----------+----+\n|R1012EIMH2B928|          5|            0|          0|   N|\n|R10374ESWDS6U7|          5|            2|          2|   N|\n|R10464NBFUUZKK|          1|            0|          4|   N|\n|R104ZHZNLUG56V|          5|            0|          0|   N|\n|R1050KH5I6Q82F|          5|            0|          0|   N|\n|R105OGH5R1MYFY|          5|            0|          0|   N|\n|R106BAPRPNZNC9|          5|            0|          0|   N|\n|R106CG9LOK6LS0|          5|            1|          1|   N|\n|R107DR8924IDG6|          1|            3|          3|   N|\n|R10A96C5D8M9FT|          2|            0|          0|   N|\n|R10CGDSH66MZIM|          1|            1|          1|   N|\n|R10DI7DFILVNYD|          5|            0|          0|   N|\n| R10EBMRNTEAFU|          5|            0|          0|   N|\n|R10ENSAS9RV07M|          5|            0|          0|   N|\n|R10GWK6OU8Y3AR|          5|            0|          0|   N|\n|R10H0QF8UMCTBS|          5|            0|          0|   N|\n|R10IFUPOW8IM1L|          5|            0|          0|   N|\n|R10JERMDEMTH4B|          5|            2|          2|   N|\n|R10JEZ85VG2VAA|          4|            0|          1|   N|\n|R10K5SUFDBF0F4|          5|            0|          0|   N|\n+--------------+-----------+-------------+-----------+----+\nonly showing top 20 rows\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20191215-152714_55456716",
      "dateCreated": "Dec 15, 2019 3:27:14 PM",
      "dateStarted": "Dec 16, 2019 12:16:34 AM",
      "dateFinished": "Dec 16, 2019 12:16:57 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nmode \u003d \"append\"\njdbc_url\u003d\"jdbc:postgresql://\u003cINSET ENDPOINT\u003e\"\nconfig \u003d {\"user\":\"\u003cINSERT USER\u003e\", \n          \"password\": \"\u003cINSERT PASSWORD\u003e\", \n          \"driver\":\"org.postgresql.Driver\"}",
      "user": "",
      "dateUpdated": "Dec 16, 2019 12:21:57 AM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "",
      "id": "20191215-152832_990072191",
      "dateCreated": "Dec 15, 2019 3:28:32 PM",
      "dateStarted": "Dec 16, 2019 12:16:57 AM",
      "dateFinished": "Dec 16, 2019 12:16:57 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nspark_df_review_id.write.jdbc(url\u003djdbc_url, table\u003d\u0027review_id_table\u0027, mode\u003dmode, properties\u003dconfig)",
      "user": "",
      "dateUpdated": "Dec 15, 2019 9:53:06 PM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "",
      "id": "20191215-154142_1617937074",
      "dateCreated": "Dec 15, 2019 3:41:42 PM",
      "dateStarted": "Dec 15, 2019 9:51:37 PM",
      "dateFinished": "Dec 15, 2019 9:53:06 PM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nproducts_df.write.jdbc(url\u003djdbc_url, table\u003d\u0027products\u0027, mode\u003dmode, properties\u003dconfig)",
      "user": "",
      "dateUpdated": "Dec 16, 2019 12:17:59 AM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "",
      "id": "20191215-154259_1886509188",
      "dateCreated": "Dec 15, 2019 3:42:59 PM",
      "dateStarted": "Dec 16, 2019 12:16:57 AM",
      "dateFinished": "Dec 16, 2019 12:17:59 AM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nvine_df.write.jdbc(url\u003djdbc_url, table\u003d\u0027vine_table\u0027, mode\u003dmode, properties\u003dconfig)",
      "user": "",
      "dateUpdated": "Dec 15, 2019 5:52:56 PM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "",
      "id": "20191215-154337_792881407",
      "dateCreated": "Dec 15, 2019 3:43:37 PM",
      "dateStarted": "Dec 15, 2019 5:43:19 PM",
      "dateFinished": "Dec 15, 2019 5:52:56 PM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nspark_customers_df \u003d spark.createDataFrame(pd_customer_df)",
      "user": "",
      "dateUpdated": "Dec 15, 2019 5:35:54 PM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "",
      "id": "20191215-173511_1713839018",
      "dateCreated": "Dec 15, 2019 5:35:11 PM",
      "dateStarted": "Dec 15, 2019 5:35:38 PM",
      "dateFinished": "Dec 15, 2019 5:35:54 PM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nspark_customers_df.write.jdbc(url\u003djdbc_url, table\u003d\u0027customers\u0027, mode\u003dmode, properties\u003dconfig)",
      "user": "",
      "dateUpdated": "Dec 15, 2019 5:36:56 PM",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "",
      "id": "20191215-154409_304979286",
      "dateCreated": "Dec 15, 2019 3:44:09 PM",
      "dateStarted": "Dec 15, 2019 5:35:58 PM",
      "dateFinished": "Dec 15, 2019 5:36:56 PM",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "",
      "user": "",
      "dateUpdated": "Dec 15, 2019 4:50:51 PM",
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "",
      "id": "20191215-165051_690905327",
      "dateCreated": "Dec 15, 2019 4:50:51 PM",
      "dateStarted": "Dec 16, 2019 12:23:05 AM",
      "dateFinished": "Dec 16, 2019 12:23:05 AM",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    }
  ],
  "name": "big-data-1",
  "id": "7b02bb8d0fd046d083ef532ada767c7b",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {},
  "info": {}
}